define(["../core","../var/support","../ajax"],function(e,t){function n(){try{return new window.XMLHttpRequest}catch(e){}}function i(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}e.ajaxSettings.xhr=void 0!==window.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&n()||i()}:n;var o=0,r={},s=e.ajaxSettings.xhr();window.ActiveXObject&&e(window).on("unload",function(){for(var e in r)r[e](void 0,!0)}),t.cors=!!s&&"withCredentials"in s,s=t.ajax=!!s,s&&e.ajaxTransport(function(n){if(!n.crossDomain||t.cors){var i;return{send:function(t,s){var a,c=n.xhr(),d=++o;if(c.open(n.type,n.url,n.async,n.username,n.password),n.xhrFields)for(a in n.xhrFields)c[a]=n.xhrFields[a];n.mimeType&&c.overrideMimeType&&c.overrideMimeType(n.mimeType),n.crossDomain||t["X-Requested-With"]||(t["X-Requested-With"]="XMLHttpRequest");for(a in t)void 0!==t[a]&&c.setRequestHeader(a,t[a]+"");c.send(n.hasContent&&n.data||null),i=function(t,o){var a,u,p;if(i&&(o||4===c.readyState))if(delete r[d],i=void 0,c.onreadystatechange=e.noop,o)4!==c.readyState&&c.abort();else{p={},a=c.status,"string"==typeof c.responseText&&(p.text=c.responseText);try{u=c.statusText}catch(f){u=""}a||!n.isLocal||n.crossDomain?1223===a&&(a=204):a=p.text?200:404}p&&s(a,u,p,c.getAllResponseHeaders())},n.async?4===c.readyState?setTimeout(i):c.onreadystatechange=r[d]=i:i()},abort:function(){i&&i(void 0,!0)}}}})});